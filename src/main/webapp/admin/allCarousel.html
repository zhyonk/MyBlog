<!doctype html>
<html>

<head>
<meta charset="utf-8">
<title>Layui</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
<link rel="stylesheet" href="css/global.css" media="all">
<script type="text/javascript" src="../js/jquery-2.1.1.js"></script>
<script type="text/javascript" src="plugins/layui/layui.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/bootstrap-table.js"></script>
<script type="text/javascript" src="../js/bootstrap-editable.js"></script>
<script type="text/javascript" src="../js/bootstrap-table-editable.js"></script>
<script type="text/javascript" src="../js/bootstrap-table-zh-CN.js"></script>
<script type="text/javascript" src="../js/sweet-alert.min.js"></script>
<link rel="stylesheet" href="../css/sweet-alert.css">
<link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="../css/bootstrap-table.css">
<link rel="stylesheet" href="../css/bootstrap-editable.css">
</head>

<body>
	<div style="margin: 15px;">
		<fieldset class="layui-elem-field layui-field-title"
			style="margin-top: 50px;">
			<legend>轮播信息</legend>
		</fieldset>
		<div id="toolbar" class="btn-group">
			<button id="btn_add" type="button" class="btn btn-default">
				<span class="glyphicon glyphicon-plus " aria-hidden="true"
					data-method="offset" data-type="auto" onclick="fun();"></span>新增
			</button>
			<button id="btn_delete" type="button" class="btn btn-default">
				<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
			</button>
		</div>
		<table id="tb_departments"></table>
		<table id="all_table">
		</table>
	</div>

	<div id="edit">
		
		
	</div>
	<script type="text/javascript">
		var TableInit = function() {
			var oTableInit = new Object();

			// 初始化Table
			var curRow = {};
			var table_option = {
				url : '../getCarousel', // 请求后台的URL（*）
				method : 'get', // 请求方式（*）
				striped : false, // 是否显示行间隔色
				cache : false, // 是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
				pagination : true, // 是否显示分页（*）
				sortable : true, // 是否启用排序
				sortOrder : "desc", // 排序方式
				queryParams : oTableInit.queryParams,// 传递参数（*）
				sidePagination : "client", // 分页方式：client客户端分页，server服务端分页（*）
				pageNumber : 1, // 初始化加载第一页，默认第一页
				pageSize : 10, // 每页的记录行数（*）
				pageList : [ 10, 25, 50, 100 ], // 可供选择的每页的行数（*）
				search : false, // 是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
				strictSearch : true,
				showColumns : false, // 是否显示所有的列
				showRefresh : true, // 是否显示刷新按钮
				minimumCountColumns : 2, // 最少允许的列数
				clickToSelect : true, // 是否启用点击选中行
				height : 500, // 行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
				uniqueId : "ID", // 每一行的唯一标识，一般为主键列
				showToggle : false, // 是否显示详细视图和列表视图的切换按钮
				cardView : false, // 是否显示详细视图
				detailView : false, // 是否显示父子表
				columns : [ {
					field : 'id',
					title : '编号',

				}, {
					field : 'big_title',
					title : '大标题',
					editable : {
						type : 'text',
						title : '大标题',
						disabled : false,
						validate : function(v) {
							if (!v)
								return '标题不能为空';
						}
					}

				}, {
					field : 'small_title',
					title : '小标题',
					editable : {
						type : 'text',
						title : '小标题',
						disabled : false,
						validate : function(v) {
							if (!v)
								return '小标题不能为空';
						}
					}
				}, {
					field : 'img_src',
					title : '图片',
					editable : {
						type : 'text',
						title : '图片',
						disabled : false,
						validate : function(v) {
							if (!v)
								return '图片不能为空';
						}
					}
				}, {
					field : 'link',
					title : '链接',
					editable : {
						type : 'text',
						title : '链接',
						disabled : false,
						validate : function(v) {
							if (!v)
								return '链接不能为空';
						}
					}
				} ],
				onClickRow : function(row, $element) {
					curRow = row;
				},
				onEditableSave : function(field, row, oldValue, $el) {
					$.ajax({
						type : "post",
						url : "../editCarousel",
						data : row,
						dataType : 'JSON',
						success : function(data, status) {
							if (status == "success") {
								swal("Good job!", "提交数据成功!", "success")
							}
						},
						error : function() {
							alert('编辑失败');
							swal("抱歉", "编辑失败", "error")
						},
						complete : function() {

						}

					});
				}
			};
			oTableInit.Init = function() {
				$('#all_table').bootstrapTable(table_option);
			};
			// 得到查询的参数
			oTableInit.queryParams = function(params) {
				var temp = { // 这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
					limit : params.limit, // 页面大小
					offset : params.offset, // 页码
					departmentname : $("#txt_search_departmentname").val(),
					statu : $("#txt_search_statu").val()
				};
				return temp;
			};
			return oTableInit;
		};

		//value: 所在collumn的当前显示值，
		//row:整个行的数据 ，对象化，可通过.获取
		//表格-操作 - 格式化 
		function actionFormatter(value, row, index) {
			return [
					'<a class="mod" href="javascript:void(0)" title="Like">',
					'<i class="glyphicon glyphicon-edit">修改&nbsp;</i>',
					'</a>  ',
					'<a class="delete" href="javascript:void(0)" title="Remove">',
					'<i class="glyphicon glyphicon-trash">删除</i>', '</a>' ]
					.join('');
		}

		//表格  - 操作 - 事件
		window.actionEvents = {
			'click .mod' : function(e, value, row, index) {
				//修改操作

			},
			'click .delete' : function(e, value, row, index) {
				//删除操作 
			}
		}

		// 1.初始化Table
		var oTable = new TableInit();
		var ini = oTable.Init();
		layui.use('layer', function() { //独立版的layer无需执行这一句
			var $ = layui.jquery, layer = layui.layer; //独立版的layer无需执行这一句

			$("#btn_add").on('click', function() {
				layer.open({
					title : '编辑',
					content : 
						'<div>'+
						'<laber>大标题</laber><input class="layui-input"></br>'+
						'<laber>小标题</laber><input class="layui-input"></br>'+
						'<laber>图片</laber><input class="layui-input"></br>'+
						'<laber>链接</laber><input class="layui-input"></br>'+
						+'</div>'
				});

			})

		});
	</script>
</body>

</html>